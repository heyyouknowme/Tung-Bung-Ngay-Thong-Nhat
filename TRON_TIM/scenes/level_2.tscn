[gd_scene load_steps=32 format=3 uid="uid://dcq743xlwyx05"]

[ext_resource type="Texture2D" uid="uid://dmv8yg16x3ml1" path="res://TRON_TIM/assets/sprites/bg level 3.png" id="1_y0kc7"]
[ext_resource type="Script" uid="uid://4hwthvf5ubsh" path="res://TRON_TIM/scripts/level 2/ui_2.gd" id="2_nrx5s"]
[ext_resource type="AudioStream" uid="uid://ddhr8pu31lxwl" path="res://TRON_TIM/assets/sounds/running.mp3" id="3_b4j7a"]
[ext_resource type="SpriteFrames" uid="uid://c88dkas6iyipo" path="res://TRON_TIM/animations/player.tres" id="3_bnod2"]
[ext_resource type="Script" uid="uid://c6bxgwoautb07" path="res://TRON_TIM/scripts/level 2/player_2.gd" id="3_wo48x"]
[ext_resource type="Script" uid="uid://crkey74qf74wk" path="res://TRON_TIM/scripts/level 2/bachan.gd" id="5_bnod2"]
[ext_resource type="SpriteFrames" uid="uid://bwwnfj1jwrw6h" path="res://TRON_TIM/animations/bachan.tres" id="6_eo635"]
[ext_resource type="Script" uid="uid://cjwrexs5vqi4" path="res://TRON_TIM/scripts/countdown_label.gd" id="7_hey2k"]
[ext_resource type="Texture2D" uid="uid://dh00gqj11aqi1" path="res://TRON_TIM/assets/sprites/object bg level 3.png" id="7_ne2mo"]
[ext_resource type="Texture2D" uid="uid://dtyhfueqg6xho" path="res://TRON_TIM/assets/sprites/visioncone.png" id="7_nxpoy"]
[ext_resource type="AudioStream" uid="uid://bmcf11s3qxjk1" path="res://TRON_TIM/assets/sounds/countdown.mp3" id="7_y0kc7"]
[ext_resource type="Script" uid="uid://mm161rd8efwf" path="res://TRON_TIM/scripts/level 2/vision_area2.gd" id="8_wy57t"]
[ext_resource type="AudioStream" uid="uid://bhscokfl3suka" path="res://TRON_TIM/assets/sounds/reng hết giờ.mp3" id="9_6cvei"]
[ext_resource type="Script" uid="uid://o2wnbq4jqpxn" path="res://MAIN/script/game_control.gd" id="9_al0ci"]
[ext_resource type="LabelSettings" uid="uid://cbiawuv7wb0ee" path="res://_SHARED ASSETS/font/red.tres" id="10_3awl3"]
[ext_resource type="Texture2D" uid="uid://d04mex2btkvfd" path="res://MAIN/assets/ui/pause_icon.png" id="10_gw1g8"]
[ext_resource type="AudioStream" uid="uid://bhobyhawe16ud" path="res://TRON_TIM/assets/sounds/warning.mp3" id="10_que50"]
[ext_resource type="Texture2D" uid="uid://bt527iaapnslo" path="res://MAIN/assets/ui/pause_screen_in_game.png" id="11_typfp"]
[ext_resource type="AudioStream" uid="uid://bhkkuoprm5lic" path="res://TRON_TIM/assets/sounds/level 2.mp3" id="12_172wr"]
[ext_resource type="Theme" uid="uid://ccjbl02crsn70" path="res://MAIN/assets/control_theme.tres" id="12_nbrg0"]
[ext_resource type="LabelSettings" uid="uid://dg7m4irgabr35" path="res://_SHARED ASSETS/font/white.tres" id="12_uqxeo"]
[ext_resource type="StyleBox" uid="uid://cjd00vb5wc7vg" path="res://MAIN/assets/control_hover.tres" id="13_bnod2"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_h3yna"]
size = Vector2(11, 26)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ph585"]
size = Vector2(9, 25)

[sub_resource type="ConvexPolygonShape2D" id="ConvexPolygonShape2D_eqhbv"]
points = PackedVector2Array(50, 43, -140, -105, -139, 138)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_al0ci"]
size = Vector2(438.387, 20.9677)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_gw1g8"]
size = Vector2(437.419, 22.9033)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_typfp"]
size = Vector2(22.5806, 251.29)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_nbrg0"]
size = Vector2(20, 281.452)

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_eo635"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_nxpoy"]

[node name="Node" type="Node"]

[node name="level 2" type="Node2D" parent="."]
scale = Vector2(3.1, 3.1)

[node name="Camera2D" type="Camera2D" parent="level 2"]
position = Vector2(0, 191)
scale = Vector2(65.6241, 65.6241)
zoom = Vector2(1.5, 1.5)

[node name="background_level2" type="Sprite2D" parent="level 2"]
z_index = -1
position = Vector2(4, 193)
scale = Vector2(0.281985, 0.278958)
texture = ExtResource("1_y0kc7")

[node name="player" type="CharacterBody2D" parent="level 2"]
position = Vector2(-97, 172)
script = ExtResource("3_wo48x")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="level 2/player"]
sprite_frames = ExtResource("3_bnod2")
animation = &"walk_up"

[node name="CollisionShape2D" type="CollisionShape2D" parent="level 2/player"]
position = Vector2(0.5, 3)
shape = SubResource("RectangleShape2D_h3yna")

[node name="FootstepSound" type="AudioStreamPlayer2D" parent="level 2/player"]
stream = ExtResource("3_b4j7a")
volume_db = 13.333

[node name="bachan" type="CharacterBody2D" parent="level 2" node_paths=PackedStringArray("patrol_points")]
position = Vector2(-3, 247)
script = ExtResource("5_bnod2")
patrol_points = [NodePath("../Waypoints/Point7"), NodePath("../Waypoints/Point8"), NodePath("../Waypoints/Point1"), NodePath("../Waypoints/Point2"), NodePath("../Waypoints/Point3"), NodePath("../Waypoints/Point4"), NodePath("../Waypoints/Point5"), NodePath("../Waypoints/Point6")]
player_path = NodePath("../player")

[node name="CollisionShape2D" type="CollisionShape2D" parent="level 2/bachan"]
position = Vector2(-0.5, 2.5)
shape = SubResource("RectangleShape2D_ph585")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="level 2/bachan"]
sprite_frames = ExtResource("6_eo635")
animation = &"walk_up"

[node name="VisionRoot" type="Node2D" parent="level 2/bachan"]
position = Vector2(1, 0)

[node name="VisionCone" type="TextureRect" parent="level 2/bachan/VisionRoot"]
z_index = -1
offset_left = -189.0
offset_top = -145.0
offset_right = -5.0
offset_bottom = 78.0
size_flags_horizontal = 0
texture = ExtResource("7_nxpoy")
expand_mode = 5
flip_h = true

[node name="Area2D" type="Area2D" parent="level 2/bachan/VisionRoot/VisionCone" node_paths=PackedStringArray("countdown_label")]
position = Vector2(96, 24)
script = ExtResource("8_wy57t")
player_path = NodePath("../../../../player")
countdown_label = NodePath("../../../../UI/CountdownLabel")

[node name="CollisionShape2D" type="CollisionShape2D" parent="level 2/bachan/VisionRoot/VisionCone/Area2D"]
position = Vector2(46, 76)
shape = SubResource("ConvexPolygonShape2D_eqhbv")

[node name="UI" type="CanvasLayer" parent="level 2"]
script = ExtResource("2_nrx5s")

[node name="CountdownLabel" type="Label" parent="level 2/UI"]
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -90.0
offset_right = 3.0
offset_bottom = 64.14
grow_horizontal = 0
theme_override_colors/font_color = Color(0.92549, 0, 0.14902, 1)
theme_override_font_sizes/font_size = 30
label_settings = ExtResource("10_3awl3")
horizontal_alignment = 1
vertical_alignment = 1
script = ExtResource("7_hey2k")
metadata/_edit_use_anchors_ = true

[node name="LevelTimerLabel" type="Label" parent="level 2/UI"]
offset_left = 20.0
offset_top = 20.0
offset_right = 60.0
offset_bottom = 86.0
label_settings = ExtResource("12_uqxeo")
metadata/_edit_use_anchors_ = true

[node name="LevelTimer" type="Timer" parent="level 2/UI"]
autostart = true

[node name="Obstacle" type="StaticBody2D" parent="level 2"]

[node name="Sprite2D" type="Sprite2D" parent="level 2/Obstacle"]
z_index = 1
position = Vector2(4, 192.25)
scale = Vector2(0.282227, 0.280762)
texture = ExtResource("7_ne2mo")

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="level 2/Obstacle"]
polygon = PackedVector2Array(160, 298, 161, 272, 154, 262, 168, 259, 181, 273, 187, 296, 161, 302)

[node name="CollisionPolygon2D2" type="CollisionPolygon2D" parent="level 2/Obstacle"]
polygon = PackedVector2Array(118, 296, 115, 308, 122, 315, 133, 307, 133, 292)

[node name="CollisionPolygon2D3" type="CollisionPolygon2D" parent="level 2/Obstacle"]
polygon = PackedVector2Array(-84, 301, -107, 309, -121, 300, -116, 293, -89, 292)

[node name="CollisionPolygon2D4" type="CollisionPolygon2D" parent="level 2/Obstacle"]
polygon = PackedVector2Array(-216, 242, -203, 243, -185, 242, -186, 228, -213, 232)

[node name="CollisionPolygon2D5" type="CollisionPolygon2D" parent="level 2/Obstacle"]
polygon = PackedVector2Array(-181, 147, -162, 146, -161, 121, -180, 128)

[node name="CollisionPolygon2D6" type="CollisionPolygon2D" parent="level 2/Obstacle"]
polygon = PackedVector2Array(92, 86, 110, 101, 143, 90, 141, 78, 138, 70, 103, 72)

[node name="CollisionPolygon2D7" type="CollisionPolygon2D" parent="level 2/Obstacle"]
position = Vector2(-3, -1)
polygon = PackedVector2Array(157, 136, 161, 148, 188, 146, 188, 131)

[node name="Waypoints" type="Marker2D" parent="level 2"]

[node name="Point1" type="Marker2D" parent="level 2/Waypoints"]
position = Vector2(-133, 207)

[node name="Point2" type="Marker2D" parent="level 2/Waypoints"]
position = Vector2(-85, 155)

[node name="Point3" type="Marker2D" parent="level 2/Waypoints"]
position = Vector2(0, 119)

[node name="Point4" type="Marker2D" parent="level 2/Waypoints"]
position = Vector2(86, 159)

[node name="Point5" type="Marker2D" parent="level 2/Waypoints"]
position = Vector2(116, 196)

[node name="Point6" type="Marker2D" parent="level 2/Waypoints"]
position = Vector2(55, 238)

[node name="Point7" type="Marker2D" parent="level 2/Waypoints"]
position = Vector2(-9, 281)

[node name="Point8" type="Marker2D" parent="level 2/Waypoints"]
position = Vector2(-87, 257)

[node name="CountDownSound" type="AudioStreamPlayer2D" parent="level 2"]
stream = ExtResource("7_y0kc7")

[node name="RengSound" type="AudioStreamPlayer2D" parent="level 2"]
stream = ExtResource("9_6cvei")

[node name="WarningSound" type="AudioStreamPlayer2D" parent="level 2"]
stream = ExtResource("10_que50")

[node name="Background Music" type="AudioStreamPlayer2D" parent="level 2"]
stream = ExtResource("12_172wr")
autoplay = true

[node name="WorldBounds" type="StaticBody2D" parent="level 2"]

[node name="CollisionShape2D" type="CollisionShape2D" parent="level 2/WorldBounds"]
position = Vector2(5.00003, 316.29)
shape = SubResource("RectangleShape2D_al0ci")

[node name="CollisionShape2D2" type="CollisionShape2D" parent="level 2/WorldBounds"]
position = Vector2(3.54839, 55.1613)
shape = SubResource("RectangleShape2D_gw1g8")

[node name="CollisionShape2D3" type="CollisionShape2D" parent="level 2/WorldBounds"]
position = Vector2(214.516, 198.548)
shape = SubResource("RectangleShape2D_typfp")

[node name="CollisionShape2D4" type="CollisionShape2D" parent="level 2/WorldBounds"]
position = Vector2(-222.903, 191.048)
shape = SubResource("RectangleShape2D_nbrg0")

[node name="Control" type="Control" parent="."]
top_level = true
z_index = 100
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -646.0
offset_top = 229.0
offset_right = -646.0
offset_bottom = 229.0
grow_horizontal = 2
grow_vertical = 2
scale = Vector2(0.67, 0.67)
mouse_filter = 2
script = ExtResource("9_al0ci")

[node name="TextureButton" type="TextureButton" parent="Control"]
layout_mode = 0
offset_left = 24.0
offset_top = 885.075
offset_right = 1048.0
offset_bottom = 2421.07
scale = Vector2(0.15, 0.15)
texture_normal = ExtResource("10_gw1g8")
texture_pressed = ExtResource("10_gw1g8")
texture_hover = ExtResource("10_gw1g8")
texture_focused = ExtResource("10_gw1g8")

[node name="Control" type="Control" parent="Control"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = 24.0
offset_bottom = 24.0
grow_horizontal = 2
grow_vertical = 2

[node name="Panel" type="Panel" parent="Control/Control"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = -24.0
grow_horizontal = 2
grow_vertical = 2

[node name="TextureRect" type="TextureRect" parent="Control/Control"]
layout_mode = 1
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -768.0
offset_right = 768.0
offset_bottom = 1024.0
grow_horizontal = 2
texture = ExtResource("11_typfp")

[node name="VBoxContainer" type="VBoxContainer" parent="Control/Control"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -220.0
offset_top = -126.0
offset_right = 230.0
offset_bottom = 166.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("12_nbrg0")
theme_override_constants/separation = 84

[node name="ResumeButton" type="Button" parent="Control/Control/VBoxContainer"]
custom_minimum_size = Vector2(450, 100)
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 4
theme = ExtResource("12_nbrg0")
theme_override_colors/font_disabled_color = Color(0, 0, 0, 1)
theme_override_colors/font_hover_pressed_color = Color(0, 0, 0, 1)
theme_override_colors/font_hover_color = Color(0, 0, 0, 1)
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_colors/font_focus_color = Color(0, 0, 0, 1)
theme_override_colors/font_pressed_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 0
theme_override_constants/h_separation = 0
theme_override_styles/hover = ExtResource("13_bnod2")
theme_override_styles/normal = SubResource("StyleBoxEmpty_eo635")
text = "Resume
"

[node name="QuitButton" type="Button" parent="Control/Control/VBoxContainer"]
custom_minimum_size = Vector2(0, 100)
layout_mode = 2
theme_override_colors/font_disabled_color = Color(0, 0, 0, 1)
theme_override_colors/font_hover_pressed_color = Color(0, 0, 0, 1)
theme_override_colors/font_hover_color = Color(0, 0, 0, 1)
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_colors/font_focus_color = Color(0, 0, 0, 1)
theme_override_colors/font_pressed_color = Color(0, 0, 0, 1)
theme_override_styles/focus = ExtResource("13_bnod2")
theme_override_styles/hover_pressed = ExtResource("13_bnod2")
theme_override_styles/hover = ExtResource("13_bnod2")
theme_override_styles/pressed = ExtResource("13_bnod2")
theme_override_styles/normal = SubResource("StyleBoxEmpty_nxpoy")
text = "Exit Game"

[connection signal="body_entered" from="level 2/bachan/VisionRoot/VisionCone/Area2D" to="level 2/bachan" method="_on_area_2d_body_entered"]
[connection signal="body_exited" from="level 2/bachan/VisionRoot/VisionCone/Area2D" to="level 2/bachan" method="_on_area_2d_body_exited"]
